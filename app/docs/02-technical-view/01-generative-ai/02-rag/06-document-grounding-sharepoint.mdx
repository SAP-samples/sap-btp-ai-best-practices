---
title: "Document Grounding with SharePoint"
description: ""
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";
import useBaseUrl from "@docusaurus/useBaseUrl";
import LoginWall from "@site/src/components/LoginWall";
import Icon from "@site/src/components/Icon";
import "@ui5/webcomponents-icons/dist/video.js";
import "@ui5/webcomponents-icons/dist/pdf-attachment.js";
import TrackableLink from "@site/src/components/TrackableLink";
import IconLinkButton from "@site/src/components/IconLinkButton";
import PageViewTracker from "@site/src/components/tracking/PageViewTracker";
import Link from "@docusaurus/Link";
import PageContributors from "@site/src/components/PageContributors";

<PageViewTracker />

<div className="hero-header">
  <h1>Document Grounding with SharePoint</h1>
</div>

<div className="section-with-background">
  <div className="row">
    <div className="col col--8">
      <h2>Steps</h2>
      <ol className="steps-list">
        <li>
          <Link to="#1-overview">Overview</Link>
        </li>
        <li>
          <Link to="#2-btp-pre-requisites">BTP Pre-requisites</Link>
        </li>
        <li>
          <Link to="#3-setting-up-guidelines">Setting up Guidelines</Link>
        </li>
      </ol>
    </div>
  </div>
</div>

## <span className="step-number">1</span> <span className="step-title">Overview</span>

### Description

SharePoint is one of the supported enterprise document sources for SAP Document Grounding. By connecting SharePoint as a repository, the service automatically ingests and processes documents stored in SharePoint libraries. This eliminates the need for building custom pipelines to fetch, chunk, and embed documents.

With the SharePoint connector, enterprises can leverage their existing collaboration platform as a reliable source of truth for Generative AI applications. Document Grounding ensures that any responses generated by Large Language Models (LLMs) are anchored in the enterprise documents stored in SharePoint.

Please refer the list of [content types](https://help.sap.com/docs/joule/integrating-joule-with-sap/set-up-document-grounding) supported with Document Grounding service.

<LoginWall>

## <span className="step-number">2</span> <span className="step-title">BTP Pre-requisites</span>

- Grounding Management on AI Core
- SharePoint tenant and [access credentials](https://help.sap.com/docs/sap-ai-core/sap-ai-core-service-guide/grounding-generic-secrets-for-microsoft-sharepoint-0cd2b30a33bb461aa0344d77a773d59a) (OAuth2 Password or OAuth2 Client Credentials)

## <span className="step-number">3</span> <span className="step-title">Setting up Guidelines</span>

If you already have SharePoint application and access credentials, please proceed with connection to Document Grounding service as mentioned in 3.2 section.

If you are to create new SharePoint application here is the set of steps to follow in order. Please note, these are the steps to be followed on Microsoft site. If any step of the process changes from Microsoft side, then please follow Microsoft guidelines to set up the application correctly.

### 3.1 SharePoint Application Set-up

**Register an Entra (Azure AD) Application for your SharePoint integration** | [Microsoft: Entra Application Set up:](https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/add-application-portal-assign-users)

- Sign in to the [Microsoft Entra admin center](https://entra.microsoft.com/) (formerly Azure AD portal) as a user with at least Application Developer or higher privileges.
- If you manage multiple tenants, use the Settings (directory switching) icon to switch to the appropriate target tenant.
- Navigate to Entra ID > App registrations (or “Azure Active Directory > App registrations”) → click New registration.
- Give your app a meaningful Name (e.g. document-grounding-joule-app) — this is the name users or admins will see.

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-01.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-02.png)

- After registration, note the Application (client) ID — you will need this later in configuration.

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-03.png)

**Configure the registered app to expose Web API scopes / roles** | [Microsoft: Application Registration](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-register-app) and [Web API Expose](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-configure-app-expose-web-apis) <br />
Your app must be able to expose scopes or roles so that other (client) components or users can be granted permissions.
- Under your registered app, assign an application owner (owner(s) who can manage the app).
  - This is usually done via a dropdown of all users in the org
- Create app roles (for application-level permissions).
  - Under Manage > App roles, click Create App role
  - Define allowed member types (Users, Applications), name, description, etc.
- Under Expose an API, do Add a scope:
  - Use a unique Scope name, provide a description (for admin and users), define “Who can consent” (Users / Admins), and set state = Enabled.
  - After adding, confirm that your scopes show up properly in the “Expose an API” pane.

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-04.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-05.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-06.png)

**Create a Group + Technical User in Entra, and assign access** | [Microsoft: Web API Permission](https://learn.microsoft.com/en-us/entra/identity-platform/quickstart-configure-app-access-web-apis) <br />
You want a service / technical user that can access the SharePoint site (via Graph API / REST) — governed via group membership.
- Create a Group (unless you already have a suitable one):
  - In Entra admin, under Groups > All groups > New Group, pick a name (e.g. DocumentGroundingServiceGroup)
  - Choose whether it’s a Security group or Microsoft 365 group (security groups are fine for access control)
  - Click Create

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-07.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-08.png)

- Create a new user (technical / service account):
  - In Entra admin, under Users > All users > New user
  - Provide user principal name, display name, initial password (you’ll change it later)
  - Assign that new user into the group you created above
  - Save / Create

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-09.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-10.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-11.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-12.png)

**Assign API Permissions to the App; grant admin consent; generate client secret** <br />
This step links your registered app to required Microsoft Graph / SharePoint permissions, and creates the secret for use in BTP.
- Open your registered app (the one from Step 2). Go to API Permissions → Add a permission.
- Under Microsoft APIs, choose Microsoft Graph.

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-13.png)

- Choose Delegated permissions (since your app will act on behalf of a user).
- Search for Sites.Read.All and User.Read (or whichever SharePoint / Graph scope you need) and Add those.
- You may see a pop-up Grant admin consent — click Yes, or afterwards click Grant admin consent for `<Tenant>`
- After consent is granted, you should see that the Sites.Read.All and User.Read permissions are configured.

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-14.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-15.png)

- Now that application has been granted permission, next is to create Client ID and Secret. Go to Certificates & secrets → Client secrets → New client secret:
  - Enter a description (e.g. “BTP Destination for Document Grounding (on behalf of User)”)
  - Set expiry (pick as long as acceptable, but note you must renew later)
  - Click Add
  - Copy the Value of the secret immediately (you won’t be able to see it again)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-16.png)

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-17.png)
Tip: Track the expiry dates carefully, as you’ll need to renew and update corresponding BTP configuration.

**Validate the technical user’s access to the SharePoint site**
- Before wiring up to BTP, confirm that your newly created technical user can actually access the SharePoint site:
- Navigate to your SharePoint site (e.g. `https://<tenant>.sharepoint.com/sites/DocumentGrounding`)
- Log in using the technical user credentials. At first login, you may need to change password (go ahead).
- Important: Do not enable multi-factor authentication (MFA / 2FA) for the technical user, because the BTP integration will not support interactive MFA.

![Setup](@site/static/generative-ai/document-grounding-sharepoint/images/setup-18.png)

- Once login succeeds and the user can see the site & documents, that confirms the user has the needed site-level access.

### 3.2 AI Launchpad Configuration for SharePoint

#### Step 3.2.1 Create Generic Secret
Create Generic Secret key collection on AI Launchpad for SharePoint. Refer [SAP Help](https://help.sap.com/docs/sap-ai-core/sap-ai-core-service-guide/grounding-generic-secrets-for-microsoft-sharepoint-0cd2b30a33bb461aa0344d77a773d59a).

#### Step 3.2.2 Create Data Repository
Navigate to Generative AI Hub > Grounding Management. Click on 'Create'.

![Configure](@site/static/generative-ai/document-grounding-sharepoint/images/setup-19.png)

Fill in the values, the Document Store Type will always be SharePoint, under the secret dropdown, select the newly created Generic Secret. The `Document  Store Name` is going to be the name of your SharePoint site. Include Paths is used to restrict the repository to a certain folder(s) within your SharePoint site, however if you want all valid documents from your site indexed, set this to `/` (single slash), otherwise set it to a path such as `testfolder`, note that this option DOES NOT allow for trailing slashes (`testfolder/` is INVALID). 

lick on create, this sets up a data pipeline to ingest valid documents from your SharePoint site to the repository, this pipeline however only runs once every 24 hours. 

Currently the AI Launchpad UI offers no option to trigger pipelines manually, they only once a day, however you can manually trigger a pipeline using the following cURL command:

![Configure](@site/static/generative-ai/document-grounding-sharepoint/images/setup-20.png)

Once all your documents have been ingested, try out your pipeline by using the `Search` functionality.

![Configure](@site/static/generative-ai/document-grounding-sharepoint/images/setup-21.png)

Enter a query, select the repositories to be searched and click on `Run`, next inspect the results retrieved.

![Configure](@site/static/generative-ai/document-grounding-sharepoint/images/setup-22.png)

You can follow steps in [Jupyter notebooks](https://github.com/SAP-samples/sap-btp-ai-best-practices/tree/main/best-practices/generative-ai/python) to perform RAG on the retrieved documents.

<br />

<div className="section-with-background gradient-violet-blue">

## Contributors

<PageContributors contributorIds={["bhagabat-prasad-behera", "iadinath-auti"]} />

</div>

</LoginWall>
